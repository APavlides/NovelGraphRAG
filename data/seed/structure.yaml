# Novel Structure Configuration for "The Liminal Space"
# Literary ghost story about acceptance vs. understanding

chapter_requirements:
  first_chapter:
    # What should be included in the opening chapter
    guidance: |
      IMPORTANT: This first chapter should establish David's central conflict between analysis and feeling:
      - Show his pattern of over-analyzing emotions as defense mechanism
      - Establish his arrival at the doomed cliff house after mother's funeral
      - Reveal his commitment to try feeling rather than understanding
      - Introduce the house's impermanence (18-24 months before it falls)
      - Show mother's hidden depth through her annotated books and paintings
      - End with his first moment of letting go - not trying to understand

    # Specific elements that should be referenced
    required_elements:
      - "over-analysis" # David's defensive pattern
      - "mother" # His deceased mother whose house this is
      - "cliff" # The eroding cliff edge
      - "impermanence" # The house's doomed timeline
      - "Yeats" # Mother's annotated poetry books
      - "funeral" # Recent event that brings him here
      - "borrowed time" # The house's 18-24 month timeline
      - "church bells" # Hint at the drowned town supernatural elements

    # Character presence requirements
    character_requirements:
      protagonist: "should dominate this chapter - his internal journey is central"
      supporting: "mother should be present through her possessions, art, and annotations"
      supernatural_entity: "drowned townspeople should be hinted at through church bells legend"
      antagonist: "Sarah should be referenced as 'she left' - the analyzed departure"

  subsequent_chapters:
    guidance: |
      Continue David's journey from analysis to acceptance.
      Show gradual encounters with ghosts representing his regrets.
      Track the house's physical deterioration as metaphor.
      Build toward his final acceptance of impermanence without understanding.

    # When to include seed data as reference in later chapters
    include_seed_reference_when:
      rag_context_shorter_than: 400 # characters
      rag_context_missing: true

# Content validation rules
validation:
  # Elements to check for in generated content
  check_elements:
    - "emotional_authenticity" # Is David's internal conflict believable?
    - "impermanence_theme" # Is the theme of impermanence present?
    - "literary_quality" # Does the prose match literary fiction standards?
    - "atmospheric_details" # Suffolk coast, cliff erosion, borrowed time?

  # Severity levels: "warning", "error", "ignore"
  missing_element_severity: "warning"

  # Retry generation if critical elements missing
  retry_on_missing: false

# Genre-specific preferences
genre:
  type: "literary_fiction"
  subgenre: "literary_ghost_story"
  conventions:
    - "character_driven"
    - "psychologically_complex"
    - "elegiac_tone"
    - "philosophical"
    - "atmospheric"
    - "introspective"

  # Tone guidance
  tone_guidance: |
    Write quiet, contemplative prose with elegiac beauty. This is literary fiction that uses 
    supernatural elements for emotional truth rather than horror. Focus on internal landscape
    matching external landscape. Use the Suffolk coast setting to create atmosphere of
    impermanence and borrowed time. Ghosts should feel like emotional reality, not horror.

# Prompt templates (customized for literary ghost story)
templates:
  system: "You are a literary novelist writing a contemplative ghost story about acceptance and impermanence."
  seed_intro: "Here is the story foundation for this literary exploration:"
  rag_intro: "Here is David's journey so far in learning to accept rather than analyze:"
  task_intro: "Continue this literary exploration:"
  formatting_guide: "Write with literary depth, focusing on internal landscape, atmospheric detail, and the quiet beauty of impermanence. Ghosts are emotional truth, not horror."

# Enhanced structure.yaml with seed data templates
seed_data_templates:
  characters:
    # How to format character information in prompts
    format: |
      **{name}** ({role}): {description}

      Internal Conflicts: {backstory_details}
      Emotional Pattern: {traits}
      Journey: {goals}
      Key Relationships: {relationships}

      {first_chapter_guidance}

    # Which fields to emphasize for first chapter
    first_chapter_fields:
      - "description"
      - "backstory_details"
      - "must_reference_in_first_chapter"
      - "traits"
      - "goals"

    # Which fields to de-emphasize or skip
    skip_fields:
      - "internal_id"
      - "creation_date"

    # Custom formatting for specific field types
    field_formatting:
      traits: "comma_separated"
      goals: "bulleted_list"
      relationships: "key_value_pairs"
      backstory_details: "bulleted_list"

  arcs:
    format: |
      **{name}**: {description}

      Transformation Journey: {key_events}
      Characters Involved: {characters}
      Thematic Focus: {themes}

    first_chapter_fields:
      - "description"
      - "key_events"
      - "themes"

    field_formatting:
      key_events: "numbered_list"
      characters: "comma_separated"
      themes: "bulleted_list"

  world:
    format: |
      **Setting & Atmosphere:**
      {locations}

      **Symbolic Landscape:**
      The Suffolk coast represents impermanence - everything here exists on borrowed time.

    first_chapter_fields:
      - "locations"

    field_formatting:
      locations: "detailed_descriptions"

  overview:
    format: |
      **Literary Vision:**
      {content}

      **Tone:** Elegiac, contemplative, quietly supernatural

    # For overview, use content but add tone guidance
    use_raw_content: false

# Template application rules
template_rules:
  # When to apply specific formatting
  apply_character_requirements_when:
    - "is_first_chapter"

  apply_arc_hints_when:
    - "is_first_chapter"

  # How verbose to be with different data types
  verbosity:
    characters: "detailed" # Need psychological depth
    arcs: "detailed" # Transformation is central
    world: "detailed" # Atmosphere crucial
    overview: "full" # Literary vision important
